<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta name="description" content="Documentation and information on writing plugins for RazorSQL.">
	<meta name="keywords" content="razorsql plugin guide">
	<link href="../images/refresh.css" rel="stylesheet" type="text/css">
	<title>RazorSQL Plugin Guide</title>
</head>

<body>
<!-- wrap starts here -->
<div id="wrap">
		
		
		<!--header -->
		<div id="header">			
				
			<h1 id="logo-text">Razor<span class="gray">SQL</span></h1>		
			<h2 id="slogan">Query, Edit, Browse, and Manage Databases</h2>
		
		<!-- menu -->	
		<div  id="header-tabs">
			<ul>
				<li  ><a href="http://www.razorsql.com/"><span>razorsql.com</span></a></li>
				
				
				
				
				
				<li  ><a href="http://www.razorsql.com/contact.php"><span>Contact</span></a></li>
			</ul>
		</div>			
		
		</div>		
			
		<!-- content-wrap starts here -->
		<div id="content-wrap">
				
			
				
			<div id="main">
			
				<h1>Plugin Guide</h1>
		<p>
		RazorSQL provides the ability for developers to write plugins, which are programs
		that can interact with RazorSQL to produce custom results.  This guide describes 
		the process for registering plugins with RazorSQL, and gives examples for
		making calls to the exposed methods of the RazorSQL plugin API.
		</p>
		<p>
		<b>Language Requirements:</b>
		</p>
		<p>
		RazorSQL requires plugins to be written using the Java programming language. 
		It is recommended that plugins are written to be executed on Java Runtime Environment (JRE) 
		version 1.4.2. Please test your plugin with RazorSQL to make sure it
		is compatible.  To guarantee compatibility across all current versions of RazorSQL,
		the plugin should be compiled using the 1.4.x compiler.  
		</p>
		<p>
		<b>Plugin Requirements:</b>
		</p>
		<p>
		Plugin code must be placed in a JAR file.  This jar file must be placed in the following 
		directory:
		</p>
		<p>
		&lt;RAZORSQL_INSTALL_DIR&gt;/plugins/
		</p>
		<p>
		There must be a Java class contained in the JAR file with the same name as the name of the JAR file.
		This class must implement the razorsql.plugins.Plugin interface and must be a member
		of the following package:
		</p>
		<p>
		razorsql.plugins
		</p>
		
		<p>
		Listed below is the Plugin interface:
		</p>
		
		<code>
		public void load();
		public String getName();
		public String getVersion();
		public String getDescription();
		</code>
		
		<p>
		<b>Plugin Example:</b>
		</p>
		<p>
		Example:
		</p>
		<p>
		Create the following file (PluginTest.java):
		</p>
		<code>
	package razorsql.plugins;
	
	import javax.swing.*;
	
	public class PluginTest implements Plugin
	{
		public void load()
		{
			System.out.println("in load() Plugin Test");
			PluginManager pluginManager = PluginManagerFactory.getInstance();
			pluginManager.log("in load() in PluginTest ");
			
			//add a menu item to the Plugins menu
			JMenuItem menuItem = new JMenuItem("Plugin Test");
			pluginManager.addPluginMenuItem(menuItem);
		}
		public String getName()
		{
			return "Plugin Test";
		}
		public String getVersion()
		{
			return "1.0";
		}
		public String getDescription()
		{
			return "An Example Plugin";
		}
	}
		</code>
		<p>
		
		<b>Compiling</b>
		</p>
		<p>
		
		To compile PluginTest.java, the pluginAPI.jar file that ships with RazorSQL needs to be placed in the CLASSPATH.  
		The pluginAPI.jar file is located in the &lt;RAZORSQL_INSTALL_DIR&gt;/plugin_api/ directory.
		
		</p>
		<p>
		<b>Storing</b>
		</p>
		<p>
		
		Once the PluginTest.java class is compiled, create a JAR file called PluginTest.jar that contains the following
		file:
		</p>
		<p>
		razorsql/plugins/PluginTest.class
		</p>
		<p>
		After creating the jar file, move it to the following directory:
		</p>
		<p>
		&lt;RAZORSQL_INSTALL_DIR&gt;/plugins/
		</p>
		<p>
		The next time RazorSQL loads, PluginTest will be available via the Plugins menu.
		
		</p>
		<p>
		
		<b>Referencing other JARs from a Plugin</b>
		</p>
		<p>
		If the plugin class must reference an external jar, that external jar can be placed in the following
		directory:
		</p>
		<p>
		&lt;RAZORSQL_INSTALL_DIR&gt;/plugins/lib/
		
		
		</p>
		<p>
		
		<b>PluginManager API</b>
		
		</p>
		<p>
		RazorSQL exposes a PluginManager class that contains methods to allow plugins to interact with
		RazorSQL.  Here is the PluginManager interface:
		</p>
		<code>
	package razorsql.plugins;

	import java.sql.*;
	import javax.swing.*;
	import java.util.*;
	
	public interface PluginManager
	{
		/**
		* Returns the current major version of RazorSQL in int format.  
		* For example, if using RazorSQL version 1.04, 1 would be returned
		* If using RazorSQL version 10.4, 10 would be returned 
		*/
		public int getMajorVersion();	
		
		/**
		* Returns the current minor version of RazorSQL in int format.  
		* For example, if using RazorSQL version 1.04, 4 would be returned
		* If using RazorSQL version 1.4, 40 would be returned.
		*/
		public int getMinorVersion();
		
		/** 
		* Returns the version as as String.  If using RazorSQL 1.04,
		* 1.04 would be returned.
		*/
		public String getVersionString();
		
		/**
		* Adds a menu item to the plugin menu.
		*/
		public void addPluginMenuItem(JMenuItem item);
		
		/**
		* Adds a separator to the plugin menu
		*/
		public void addPluginMenuSeparator();
		
		/**
		* Legacy version of getText method
		*/
		public String getEditorContents();
		
		/**
		* Returns the current contents of the SQL editor in the 
		* currently displayed window in String format
		*/
		public String getText();
		
		/**
		* Returns the text of the editor in the currently
		* displayed tab in String format starting at the start position
		* until the specified length
		*/
		public String getText (int start, int length);
		
		/**
		* Returns the selected text of the editor in the currently
		* active tab, or null if there is no text selected
		*/
		public String getSelectedText();
		
		/**
		* Sets the text in the editor in the currently displayed tab
		*/
		public void setText (String text);
		
		/**
		* Replaces the current selection with the text, or 
		* if there is not selection, inserts the text into the editor
		* at the current cursor position
		*/
		public void setSelectedText (String text);
		
		/**
		* Returns the line number (0 based) that the cursor is currently on
		*/
		public int getCursorLine();
		
		/**
		* Returns the offset in the editor for the cursor position
		*/
		public int getCursorPosition();
		
		/**
		* Returns the line number which contains the passed in position
		*/
		public int getLineForPosition (int position);
		
		/**
		* Returns the total number of lines in the editor
		*/
		public int getLineCount();
		
		/**
		* Returns the text of the line for the lineNumber
		*/
		public String getLineText (int lineNumber);
		
		/**
		* Selects text from start to end
		*/
		public void select (int start, int end);
		
		/**
		* Sets the cursor position to the specified position
		*/
		public void setCursorPosition (int position);
		
		/**
		* Returns the current Connection being used in
		* the currently displayed window
		*/
		public Connection getConnection();
		
		/**
		* Logs to the RazorSQL log file
		* The logfile is located in the razorsql/logs 
		* directory under $USER_HOME directory.  $USER_HOME
		* is retrieved by doing a System.getProperty("user.home")
		*/
		public void log(Object obj);
		
		/**
		* Logs a query to the query log
		*/
		public void logQuery(String query);
		
		/**
		* Gets the number of columns returned 
		* from the last executed query on the currently
		* displayed window
		*/
		public int getColumnCount();
		
		/**
		* Gets the names of the columns 
		* returned from the last executed query on the
		* currently displayed window
		*/
		public String[] getColumnNames();
		
		/**
		* Gets the number of rows fetched from the ResultSet
		* from the last executed query on the currently displayed window
		* NOTE: There may or may not be more rows in the ResultSet that 
		* have yet to be fetched.
		*/
		public int getDisplayedRowCount();
		
		/**
		* Gets the values for each column in the 
		* displayed row at the passed in index on the 
		* currently displayed window
		*/
		public String[] getDisplayedRow (int rowIndex);
		
		/**
		* Tries to fetch the next row from the ResultSet
		* from the last executed query on the currently displayed
		* window.  If there is not a next row, null is returned.
		*/
		public String[] getNextUndisplayedRow();
		
		/**
		* Returns all rows tied to the current query.  Both the 
		* rows already displayed in the query results table, and
		* rows not yet fetched from the result set
		* returns a java.util.List of java.lang.String[] objects
		*/
		public List getAllRows();
		
		/**
		* Returns the catalog / database of the currently selected
		* Navigator node, or null if there is no node selected.
		*/
		public String getCurrentNavigatorCatalog();
		
		/**
		* Returns the schema / owner of the current selected
		* Navigator node, or null if there is no node selected or
		* the selected node is above the schema / owner level
		*/
		public String getCurrentNavigatorSchema();
		
		/**
		* Returns the name of the currently selected Navigator node,
		* or null if no node is selected
		*/
		public String getCurrentNavigatorNode();
		
		/**
		* Returns the type of the selected Navigator node.  Returns null
		* if the current selected node is not a database object, but just a
		* descriptor node such as "Tables", etc.  Returns null if the selected
		* object is not one of the options listed below.
		* Options include the following:
		CATALOG
		SCHEMA
		TABLE
		SYSTEM_TABLE
		VIEW
		INDEX
		PROCEDURE
		FUNCTION
		TRIGGER
		PACKAGE
		PACKAGE_BODY
		SEQUENCE
		SYNONYM
		CONSTRAINT
		COLUMN
		*/
		public String getCurrentNavigatorNodeType();
		
		/**
		* Open a new tab sharing the connection of the current tab
		*/
		public void openNewConnectedTab ();
		
		/**
		* Executes a query that returns results on the current 
		* connection and displays the results
		* in a query results tab
		*/
		public void executeQuery (String query);
		
		/**
		* Returns a handle to the main RazorSQL frame
		*/
		public JFrame getMainFrame();
		
		/**
		* Returns whether or not the user has a registered
		* copy of RazorSQL
		*/
		public boolean isRegistered();
	}

		</code>
		<p>
		<b>Complete Plugin Example </b>
		
		</p>
		<p>
		Here is an example plugin that shows the uses of the PluginManager.
		</p>
		<code>
	package razorsql.plugins;
	
	import javax.swing.*;
	import java.awt.event.*;
	import java.sql.*;
	import java.util.*;
	
	public class PluginExample implements Plugin
	{
		
		public void load()
		{
			PluginManager pluginManager = PluginManagerFactory.getInstance();
			
			pluginManager.log("in load() in PluginExample ");
			
			//add a menu item to the Plugins menu
			JMenuItem menuItem = new JMenuItem("Plugin Example");
			pluginManager.addPluginMenuItem(menuItem);
			
			//add an ActionListener to perform operations when the
			//menu item is selected
			menuItem.addActionListener(new PluginExampleListener());
		}
		
		public String getName()
		{
			return "Plugin Example";
		}
	
		public String getVersion()
		{
			return "1.0";
		}
		
		public String getDescription()
		{
			return "Example of how to use RazorSQL plugins";
		}
		
		private static class PluginExampleListener implements ActionListener
		{
		
			public PluginExampleListener()
			{}	
			
			public void actionPerformed(ActionEvent e)
			{
				PluginManager pluginManager = 
					PluginManagerFactory.getInstance();
				pluginManager.log("in actionPerformed");
				
				int majorVersion = pluginManager.getMajorVersion();
				int minorVersion = pluginManager.getMinorVersion();
				String versionString = pluginManager.getVersionString();
				boolean registered = pluginManager.isRegistered();
				String editorContents = pluginManager.getEditorContents();
				int columnCount = pluginManager.getColumnCount();
				String[] columnNames = pluginManager.getColumnNames();
				int displayedRowCount = 
					pluginManager.getDisplayedRowCount();
				String[] displayedRow0 = null;
				if (displayedRowCount > 0)
				{
					displayedRow0 = pluginManager.getDisplayedRow(0);	
				}
				String[] nextUndisplayedRow = 
					pluginManager.getNextUndisplayedRow();
				List allRows = pluginManager.getAllRows();
				
				Connection con = pluginManager.getConnection();
				
				JPanel testPanel = new JPanel();
				JTextArea textArea = new JTextArea(20,50);
				JScrollPane scrollPane = new JScrollPane(textArea);
				testPanel.add(scrollPane);
				
				textArea.append("Major Version: "+majorVersion);
				textArea.append("\n");
				textArea.append("Minor Version: "+minorVersion);
				textArea.append("\n");
				textArea.append("Version String: "+versionString);
				textArea.append("\n");
				textArea.append("Registered: "+registered);
				textArea.append("\n");
				textArea.append("Editor Contents: "+editorContents);
				textArea.append("\n"); 
				textArea.append("Column Count: "+columnCount);
				textArea.append("\n");
				if (con != null)
				{
					Statement stmt = null;
					ResultSet rs = null;
					try
					{
						DatabaseMetaData metaData = 
							con.getMetaData();
						String databaseProduct = 
							metaData.getDatabaseProductName();
						textArea.append(
							"Database Product Name: " 
							+databaseProduct);
						textArea.append("\n");
						stmt = con.createStatement();
						String query = "select id from data";
						pluginManager.logQuery(query);
						rs = stmt.executeQuery(query);
						if (rs.next())
						{
							textArea.append("Query Result 0: " +
								rs.getString(1));
							textArea.append("\n");	
						}
					}
					catch (SQLException ex)
					{
						pluginManager.log(ex);	
					}
					finally
					{
						if (rs != null)
						{
							try
							{
								rs.close();
							}
							catch (Exception ex)
							{}	
						}
						if (stmt != null)
						{
							try
							{
								stmt.close();	
							}	
							catch (Exception ex)
							{}
						}
					}	
				}
				if (columnNames != null)
				{
					textArea.append("Column Names: ");
					int len = columnNames.length;
					int check = len-1;
					for (int i = 0; i &lt; len; i++)
					{
						textArea.append(columnNames[i]);	
						if (i &lt; check)
						{
							textArea.append(",");	
						}
					}	
					textArea.append("\n");
				}
				textArea.append("Displayed Row Count: " +
					displayedRowCount);
				textArea.append("\n");
				if (displayedRow0 != null)
				{
					textArea.append("Displayed Row 0: ");
					int len = displayedRow0.length;
					int check = len-1;
					for (int i = 0; i &lt; len; i++)
					{
						textArea.append(displayedRow0[i]);	
						if (i &lt; check)
						{
							textArea.append(",");	
						}
					}	
					textArea.append("\n");
				}
				if (nextUndisplayedRow != null)
				{
					textArea.append("Displayed Row 0: ");
					int len = nextUndisplayedRow.length;
					int check = len-1;
					for (int i = 0; i &lt; len; i++)
					{
						textArea.append(nextUndisplayedRow[i]);	
						if (i &lt; check)
						{
							textArea.append(",");	
						}
					}	
					textArea.append("\n");
				}
				if (allRows != null)
				{
					textArea.append("All Rows:");
					Iterator iter = allRows.iterator();
					while (iter.hasNext())
					{
						String[] arr = (String[])iter.next();
						if (arr != null)
						{
							int len = arr.length;
							int check = len-1;
							for (int i = 0; i &lt; len; i++)
							{
								textArea.append(arr[i]);	
								if (i &lt; check)
								{
									textArea.append(",");	
								}
							}
						}	
						textArea.append("\n");
					}	
					textArea.append("\n");
				}
				
				JFrame testFrame = new JFrame("PluginExample");
				testFrame.setSize(400,400);
				testFrame.getContentPane().add(testPanel);
				testFrame.pack();
				testFrame.setVisible(true);
			}
		}
	}
		</code>
			</div>
		
					<div id="sidebar">
					
				<div class="h1-light"><a href="installation.html">Installation</a></div>
				
				<div class="h1-light"><a href="application_menus.html">Complete Feature Reference</a></div>
				
				<div class="h1-light"><a href="getting_started.html">Getting Started</a></div>
					<div class="left-box">
					<ul>
						<li><a href="how_to_connect.html">How to Get Connected</a></li>
						<li><a href="how_to_query.html">How to Execute Queries</a></li>
						<li><a href="how_to_create_table.html">How to Create Tables</a></li>
						<li><a href="how_to_search_data.html">How to Search for Data</a></li>
						<li><a href="how_to_search_objects.html">How to Search for Objects</a></li>
						<li><a href="how_to_import.html">How to Import Data</a></li>
						<li><a href="how_to_export.html">How to Export Data</a></li>
						<li><a href="how_to_edit.html">How to Edit Data</a></li>
						<li><a href="how_to_files.html">How to Work with Files</a></li>			
					</ul>
					</div>
				
				<div class="h1-light"><a href="getting_connected.html">Getting Connected</a></div>
					<div class="left-box">
					<ul>
						<li><a href="database_specific_help.html">Database Specific Help</a></li>
						<li><a href="jdbc_odbc.html">General Connection Help</a></li>
						<li><a href="connection_wizard.html">Connection Wizard</a></li>
						<li><a href="builtin_connection.html">Built-in Connection Support</a></li>
						<li><a href="included_drivers.html">Included Drivers</a></li>
						<li><a href="razorsql_mysql_bridge.html">RazorSQL MySQL PHP Bridge</a></li>
						<li><a href="razorsql_postgresql_bridge.html">PostgreSQL PHP Bridge</a></li>
						<li><a href="razorsql_sqlserver_bridge.html">SQL Server PHP Bridge</a></li>
						<li><a href="razorsql_sqlserver_asp_bridge.html">SQL Server ASP Bridge</a></li>
						<li><a href="razorsql_jdbc_bridge.html">JDBC Bridge</a></li>
						<li><a href="sqlite_driver.html">RazorSQL SQLite Driver</a></li>
						<li><a href="odbc_setup.html">ODBC Help</a></li>
						<li><a href="database_specific.html">Manual Database Specific JDBC Help</a></li>
						<li><a href="driver_download.html">Where to Find JDBC Drivers</a></li>
						
					</ul>
					</div>
				
				<div class="h1-light"><a href="table_tools.html">Table Tools</a></div>
					<div class="left-box">
					<ul>				
						<li><a href="create_table.html">Create Table</a></li>
						<li><a href="create_view.html">Create View</a></li>
						<li><a href="create_index.html">Create Index</a></li>
						<li><a href="create_sequence.html">Create Sequence</a></li>
						<li><a href="edit_table.html">Edit Table</a></li>
						<li><a href="describe_table.html">Describe Table</a></li>
						<li><a href="alter_table.html">Alter Table</a></li>
						<li><a href="alter_view.html">Alter View</a></li>
						<li><a href="view_table.html">View Table</a></li>
						<li><a href="column_lookup.html">Column Lookup</a></li>
						<li><a href="table_lookup.html">Table Lookup</a></li>
						<li><a href="query_builder.html">Query Builder</a></li>
						<li><a href="drop_table.html">Drop Table</a></li>
						<li><a href="drop_view.html">Drop View</a></li>
						<li><a href="drop_index.html">Drop Index</a></li>
						<li><a href="drop_sequence.html">Drop Sequence</a></li>
					</ul>	
					</div>
				<div class="h1-light"><a href="procedure_tools.html">Stored Procedure / Function <br>
				/ Trigger Tools</a></div>
					<div class="left-box">
					<ul>
						<li><a href="view_procedure.html">View Procedure / Function / Trigger</a></li>
						<li><a href="edit_procedure.html">Procedure Editor</a></li>
						<li><a href="edit_function.html">Function Editor</a></li>
						<li><a href="edit_trigger.html">Trigger Editor</a></li>
						<li><a href="edit_package.html">Package Editor</a></li>
						<li><a href="edit_package.html">Package Body Editor</a></li>
						<li><a href="create_function.html">Create Function</a></li>
						<li><a href="create_procedure.html">Create Procedure</a></li>
						<li><a href="create_trigger.html">Create Trigger</a></li>
						<li><a href="create_package.html">Create Package</a></li>
						<li><a href="create_package_body.html">Create Package Body</a></li>
						<li><a href="execute_procedure.html">Execute Procedure / Function</a></li>
						<li><a href="drop_function.html">Drop Function</a></li>
						<li><a href="drop_procedure.html">Drop Procedure</a></li>
						<li><a href="drop_trigger.html">Drop Trigger</a></li>
						<li><a href="oracle_drop_package.html">Drop Package</a></li>
						<li><a href="oracle_drop_package_body.html">Drop Package Body</a></li>
					</ul>
					</div>
				<div class="h1-light"><a href="data_tools.html">Data Tools</a></div>
					<div class="left-box">
					<ul>
						<li><a href="export.html">Export</a></li>
						<li><a href="import.html">Import</a></li>
						<li><a href="compare.html">Compare</a></li>
					</ul>
					</div>
				<div class="h1-light"><a href="sql_tools.html">SQL Tools</a></div>
					<div class="left-box">
					<ul>
						<li><a href="sql_execute.html">Execute</a></li>
						<li><a href="sql_execute_fetch_all.html">Execute Fetch All</a></li>
						<li><a href="sql_execute_all.html">Execute All</a></li>
						<li><a href="sql_explain.html">Explain Plan</a></li>
						<li><a href="sql_commit_rollback.html">Commit / Rollback</a></li>
						<li><a href="sql_history.html">SQL History</a></li>
						<li><a href="sql_formatter.html">SQL Formatter</a></li>
						<li><a href="query_scheduler.html">Query Scheduler</a></li>
						<li><a href="ddl_generator.html">Generate DDL</a></li>
					</ul>
					</div>
				<div class="h1-light"><a href="database_tools.html">Database Tools</a></div>
					<div class="left-box">
					<ul>
						<li><a href="database_navigator.html">Database Navigator</a></li>
						<li><a href="database_search.html">Database Search</a></li> 
						<li><a href="database_object_search.html">Database Object Search</a></li> 
						<li><a href="database_meta.html">Meta Data Viewer</a></li>
						<li><a href="create_database.html">Create Database</a></li>
						<li><a href="create_user.html">Create User</a></li>
						<li><a href="drop_database.html">Drop Database</a></li>
						<li><a href="drop_user.html">Drop User</a></li>
					</ul>
					</div>
				<div class="h1-light"><a href="command_line.html">Command Line Interface</a></div>
				<div class="h1-light"><a href="builtin_database.html">Built-in Database</a></div>
				<div class="h1-light"><a href="editor_tools.html">Editor Tools</a></div>
					<div class="left-box">
					<ul>
					
						<li><a href="sql_editor.html">SQL Editor</a></li>
						<li><a href="sort_query_results.html">Sort Query Results</a></li>
						<li><a href="filter_query_results.html">Filter Query Results</a></li>
						<li><a href="search_query_results.html">Search Query Results</a></li>
						<li><a href="query_navigator.html">Query Navigator</a></li>
						<li><a href="auto_column_lookup.html">Auto Column Lookup</a></li>
						<li><a href="auto_table_lookup.html">Auto Table Lookup</a></li>
						<li><a href="parameterized_queries.html">Parameterized Queries</a></li>
						<li><a href="function_lookup.html">Function Lookup</a></li>
						<li><a href="keyahead.html">Key Ahead</a></li>
						<li><a href="execute_shell.html">Execute Shell / Batch Scripts</a></li>
						<li><a href="find_replace.html">Find / Replace</a></li>
						<li><a href="find_replace_in_files.html">Find / Replace in Files</a></li>
						<li><a href="replace_range.html">Replace Range</a></li>
						<li><a href="match_bracket.html">Match Bracket</a></li>
						<li><a href="match_tag.html">Match Tag</a></li>
						<li><a href="file_compare.html">File Compare</a></li>
					</ul>
					</div>
				<div class="h1-light"><a href="plugin_guide.html">Plugin Guide</a></div>
				<div class="h1-light"><a href="preferences.html">Preferences</a></div>
				<div class="h1-light"><a href="support_questions.html">Common Support Questions</a></div>
			</div>	
		
		<!-- content-wrap ends here -->	
		</div>
					
				<!--footer starts here-->
		<div id="footer">
			
		<span id="footer-left">
			&copy; 2011 <strong><a href="http://www.richardsonsoftware.com/">Richardson Software, LLC</a></strong> | 
			 
			
			<a href="http://www.razorsql.com/">Home</a>
			
   		</span>
				
		</div>	
<!-- wrap ends here -->
</div>
<!--stats--></body>
</html>
